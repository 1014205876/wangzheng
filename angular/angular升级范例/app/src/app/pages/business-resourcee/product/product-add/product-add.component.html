<app-breadcrumbs [breadcrumbs]="['业务资源管理','产品管理','创建产品']"></app-breadcrumbs>
<nz-card class="card" [nzTitle]="'基本信息'">
    <div nz-row>
        <div nz-col nzSpan="24">
            <form nz-form [formGroup]="baseDetForm" class="form">
                <div nz-row [nzGutter]="24">
                    <div nz-col [nzSpan]="6">
                        <nz-form-item>
                            <nz-form-label nzRequired nzFor="name">产品名称</nz-form-label>
                            <nz-form-control>
                                <input nz-input formControlName="name" type="text" maxlength="50"
                                     placeholder="请输入产品名称">
                                <nz-form-explain
                                    *ngIf="baseDetForm.get('name').dirty && baseDetForm.get('name').errors">
                                    产品名称不能为空，最大50个字符!</nz-form-explain>
                            </nz-form-control>
                        </nz-form-item>
                    </div>
                    <div nz-col [nzSpan]="6">
                        <nz-form-item>
                            <nz-form-label nzRequired nzFor="number">产品编码</nz-form-label>
                            <nz-form-control>
                                <input nz-input formControlName="number" type="text" maxlength="20"
                                     placeholder="请输入产品编码">
                                <nz-form-explain
                                    *ngIf="baseDetForm.get('number').dirty && baseDetForm.get('number').errors">
                                    产品编码不能为空，最大20个字符!</nz-form-explain>
                            </nz-form-control>
                        </nz-form-item>
                    </div>
                    <div nz-col [nzSpan]="6">
                        <nz-form-item>
                            <nz-form-label nzRequired>贷款期限范围</nz-form-label>
                            <nz-form-control>
                                <nz-input-number formControlName="minTerm" [nzMin]="1" [nzStep]="1">
                                </nz-input-number>
                                <span>至</span>
                                <nz-input-number formControlName="maxTerm"
                                    [nzMin]="items.product.minTerm" [nzStep]="1"></nz-input-number>
                                <span>月</span>
                                <nz-form-explain
                                    *ngIf="baseDetForm.get('minTerm').dirty && baseDetForm.get('minTerm').errors">
                                    最小贷款期限不能为空!</nz-form-explain>
                                <nz-form-explain
                                    *ngIf="baseDetForm.get('maxTerm').dirty && baseDetForm.get('maxTerm').errors">
                                    最大贷款期限不能为空!</nz-form-explain>
                                <nz-form-explain *ngIf="items.product.minTerm>items.product.maxTerm">最小范围不能大于最大范围!
                                </nz-form-explain>
                            </nz-form-control>
                        </nz-form-item>
                    </div>
                    <div nz-col [nzSpan]="6">
                        <nz-form-item>
                            <nz-form-label nzRequired>贷款金额范围</nz-form-label>
                            <nz-form-control>
                                <nz-input-number formControlName="minAmount" [nzMin]="1" [nzStep]="1"></nz-input-number>
                                <span>至</span>
                                <nz-input-number formControlName="maxAmount" [nzMin]="items.product.minAmount" [nzStep]="1"></nz-input-number>
                                <span>万元</span>
                                <nz-form-explain
                                    *ngIf="baseDetForm.get('minAmount').dirty && baseDetForm.get('minAmount').errors">
                                    最小贷款金额不能为空!</nz-form-explain>
                                <nz-form-explain
                                    *ngIf="baseDetForm.get('maxAmount').dirty && baseDetForm.get('maxAmount').errors">
                                    最大贷款金额不能为空!</nz-form-explain>
                                <nz-form-explain *ngIf="items.product.minAmount>items.product.maxAmount">最小范围不能大于最大范围!
                                </nz-form-explain>
                                <!-- <nz-form-explain *ngIf="baseDetForm.get('minAmount').dirty && baseDetForm.get('minAmount').errors">最小贷款金额不能为空!</nz-form-explain> -->
                                <!-- <nz-form-explain *ngIf="baseDetForm.get('maxAmount').dirty && baseDetForm.get('maxAmount').errors">最大贷款金额不能为空!</nz-form-explain> -->
                                <!-- <nz-form-explain *ngIf="baseDetForm.get('minAmount').hasError('confirm')||baseDetForm.get('maxAmount').hasError('confirm')">最大范围不能小于最小范围!</nz-form-explain> -->
                            </nz-form-control>
                        </nz-form-item>
                    </div>
                    <div nz-col [nzSpan]="6">
                        <nz-form-item>
                            <nz-form-label nzRequired>综合费率</nz-form-label>
                            <nz-form-control>
                                <nz-input-number formControlName="minRate"
                                    [nzMin]="0" [nzMax]="100" [nzFormatter]="formatterPercent"
                                    [nzParser]="parserPercent"></nz-input-number>
                                <span>至</span>
                                <nz-input-number formControlName="maxRate"
                                    [nzMin]="items.product.minRate" [nzMax]="100" [nzFormatter]="formatterPercent"
                                    [nzParser]="parserPercent"></nz-input-number>
                                <nz-form-explain
                                    *ngIf="baseDetForm.get('minRate').dirty && baseDetForm.get('minRate').errors">
                                    最小综合费率不能为空!</nz-form-explain>
                                <nz-form-explain
                                    *ngIf="baseDetForm.get('maxRate').dirty && baseDetForm.get('maxRate').errors">
                                    最大综合费率不能为空!</nz-form-explain>
                                <nz-form-explain *ngIf="items.product.minRate>items.product.maxRate">最小综合费率不能大于最大综合费率!
                                </nz-form-explain>
                                <!-- <nz-form-explain *ngIf="baseDetForm.get('minRate').dirty && baseDetForm.get('minRate').errors">最小综合费率不能为空!</nz-form-explain> -->
                                <!-- <nz-form-explain *ngIf="baseDetForm.get('maxRate').dirty && baseDetForm.get('maxRate').errors">最大综合费率不能为空!</nz-form-explain> -->
                                <!-- <nz-form-explain *ngIf="baseDetForm.get('minRate').hasError('confirm')||baseDetForm.get('maxRate').hasError('confirm')">最大范围不能小于最小范围!</nz-form-explain> -->
                            </nz-form-control>
                        </nz-form-item>
                    </div>
                    <div nz-col [nzSpan]="6">
                        <nz-form-item>
                            <nz-form-label nzRequired nzFor="status">状态</nz-form-label>
                            <nz-form-control>
                                <nz-radio-group formControlName="status">
                                    <label nz-radio nzValue="1">启用</label>
                                    <label nz-radio nzValue="0">禁用</label>
                                </nz-radio-group>
                                <nz-form-explain
                                    *ngIf="baseDetForm.get('status').dirty && baseDetForm.get('status').errors">状态不能为空!
                                </nz-form-explain>
                            </nz-form-control>
                        </nz-form-item>
                    </div>
                    <div nz-col [nzSpan]="6">
                        <nz-form-item>
                            <nz-form-label nzRequired nzFor="productType">产品类型</nz-form-label>
                            <nz-form-control>
                                <nz-select style="width: 100%;"
                                    formControlName="productType">
                                    <nz-option nzValue="" nzLabel="请选择产品类型"></nz-option>
                                    <nz-option nzValue="{{item.code}}" nzLabel="{{item.name}}"
                                        *ngFor="let item of productTypes">
                                    </nz-option>
                                </nz-select>
                                <nz-form-explain
                                    *ngIf="baseDetForm.get('productType').dirty && baseDetForm.get('productType').errors">
                                    产品类型不能为空!</nz-form-explain>
                            </nz-form-control>
                        </nz-form-item>
                    </div>
                    <div nz-col [nzSpan]="6">
                        <nz-form-item>
                            <nz-form-label nzFor="productProvider">产品提供方</nz-form-label>
                            <nz-form-control>
                                <nz-select style="width: 100%;"
                                    formControlName="productProvider">
                                    <nz-option nzValue="" nzLabel="请选择产品提供方"></nz-option>
                                    <nz-option nzValue="{{item.code}}" nzLabel="{{item.name}}"
                                        *ngFor="let item of productProviders">
                                    </nz-option>
                                </nz-select>
                                <!-- <nz-form-explain
                                    *ngIf="baseDetForm.get('productProvider').dirty && baseDetForm.get('productProvider').errors">
                                    产品提供方不能为空!</nz-form-explain> -->
                            </nz-form-control>
                        </nz-form-item>
                    </div>
                </div>
            </form>
            <div nz-form class="form">
                <div nz-row [nzGutter]="24">
                    <div nz-col [nzSpan]="24">
                        <nz-form-item>
                            <nz-form-label nzRequired>支持还款方式</nz-form-label>
                            <nz-form-control>
                                <div style="width: 100%">
                                    <nz-checkbox-wrapper style="width: 100%;" (nzOnChange)="checkRepayMethod($event)">
                                        <div nz-row >
                                            <div nz-col [nzSpan]="4" *ngFor="let item of applyRepayMethods">
                                                <label nz-checkbox nzValue="{{item.code}}"
                                                    [(ngModel)]="item.checked">{{item.name}}</label>
                                            </div>
                                        </div>
                                    </nz-checkbox-wrapper>
                                    <nz-form-explain *ngIf="(!RepayMethodValid)&&items.product.repayMethod.length==0">
                                        还款方式不能为空！
                                    </nz-form-explain>
                                </div>
                            </nz-form-control>
                        </nz-form-item>
                    </div>
                    <div nz-col [nzSpan]="24">
                        <nz-form-item>
                            <nz-form-label>简介描述</nz-form-label>
                            <nz-form-control>
                                <textarea nz-input [(ngModel)]="items.product.remark" rows="2"
                                    placeholder="请输入简介描述"></textarea>
                            </nz-form-control>
                        </nz-form-item>
                    </div>
                </div>
            </div>
        </div>
    </div>
</nz-card>
<nz-card class="card" [nzTitle]="'产品介绍'">
    <app-tiny-editor [elementId]="'my-editor'" (onEditorContentChange)="keyupHandler1($event,items.product)"
        [initialContent]="items.product.productIntroduction"></app-tiny-editor>
</nz-card>

<div nz-row style="text-align: center;">
    <button nz-button nzType="default" (click)='goBack()'>返回</button>
    <button nz-button nzType="primary" (click)='addProduct()' style="margin-left: 10px;">确定</button>
</div>